import { Card, CardBody } from "@nextui-org/card";
import axios from "axios";
import { useEffect, useState } from "react";
import { Spinner } from "@nextui-org/react";

const VijapurMap = () => {
  const [vijapurTotal, setVijapurTotal] = useState(null);
  const [vijapurData, setVijapurData] = useState(null);

  useEffect(() => {
    const fetchPopsDataVijapur = async () => {
      try {
        const token = localStorage.getItem("token");
        const response = await axios.get(
          // "https://didbackend.onrender.com/agepops",
          // "http://localhost:5000/agepops/",
          `${import.meta.env.VITE_BACKEND_URL}/agepops`,
          {
            headers: {
              Authorization: `Bearer ${token}`,
            },
            withCredentials: true,
          }
        );
        if (response.data) {
          const vijapurData = response.data.find(
            (entry) => entry.taluka_name === "Vijapur"
          );
          if (vijapurData) {
            const vijapurTotal = vijapurData.total_population;
            console.log("Total for Vijapur:", vijapurTotal);
            setVijapurTotal(vijapurTotal);
          } else {
            console.log("Data for Vijapur not found");
          }
        } else {
          console.log("Invalid response format");
        }
      } catch (error) {
        console.error("Error fetching data:", error.message);
      }
    };

    const fetchVijapurData = async () => {
      try {
        const token = localStorage.getItem("token");
        const response = await axios.get(
          // "https://didbackend.onrender.com/getcitiesdata",
          // "http://localhost:5000/getcitiesdata/",
          `${import.meta.env.VITE_BACKEND_URL}/getcitiesdata`,
          {
            headers: {
              Authorization: `Bearer ${token}`,
            },
            withCredentials: true,
          }
        );

        if (response.data && Array.isArray(response.data.data)) {
          const vijapurData = response.data.data.find(
            (city) => city.taluka_name === "Vijapur"
          );

          if (vijapurData) {
            console.log("Vijapur data:", vijapurData);
            setVijapurData(vijapurData);
          } else {
            console.log("Vijapur data not found");
          }
        } else {
          console.log("Invalid response format");
        }
      } catch (error) {
        console.error("Error fetching data:", error.message);
      }
    };

    fetchVijapurData();
    fetchPopsDataVijapur();
  }, []);

  return (
    <div className="flex flex-col justify-center items-center min-h-screen p-4 overflow-auto">
      <Card className="flex justify-center max-w-md w-full mb-2">
        <CardBody>
          <svg
            style={{ maxWidth: "400px" }}
            width=""
            height=""
            viewBox="0 0 286 280"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M62.0629 264.38C60.3479 264.87 58.1999 271.006 58.1042 270.24C56.3611 271.208 54.565 271.082 52.6492 271.082C50.4752 271.082 48.3856 270.521 46.3214 270.521C44.4612 270.521 41.2676 271.173 39.5883 270.24C35.9905 268.241 31.6416 270.187 29.3329 266.032C28.2945 264.163 26.3483 264.052 27.2444 261.543C27.8007 259.986 28.7145 257.669 27.2444 256.493C24.3988 254.217 22.1352 251.496 21.9141 247.516C21.7946 245.365 22.2083 240.814 23.3168 238.819C24.0011 237.588 23.5974 235.438 23.5974 234.05C23.5974 231.809 20.8615 233.44 19.5451 233.489C15.029 233.656 13.5629 231.772 9.85077 230.122C8.25827 229.415 7.93466 226.246 6.64011 226.195C4.44146 226.107 3.95352 226.187 2.7125 224.636C2.01525 223.765 1.97924 221.343 2.55665 220.303C3.84965 217.976 4.29496 219.792 5.92316 219.43C7.63854 219.049 9.9451 218.961 10.8171 217.217C11.5329 215.786 12.6506 213.851 10.1313 213.851C7.41506 213.851 6.20371 214.368 6.20371 211.326C6.20371 209.782 7.91284 208.801 9.28968 208.801C13.5991 208.801 14.8329 206.895 17.5501 203.876C19.3614 201.863 16.2215 200.933 14.8694 200.073C12.7398 198.718 13.9851 197.018 16.0539 197.018C19.0868 197.018 23.3369 197.944 26.4028 196.582C27.9359 195.9 30.0502 195.896 31.7331 195.896C33.0876 195.896 33.6069 197.665 34.5386 198.39C36.3731 199.817 37.8102 196.271 38.7467 195.335C39.9931 194.089 41.6215 194.213 43.2354 194.213C46.159 194.213 49.8948 192.134 51.0906 189.444C52.3122 186.695 54.8472 183.826 55.0182 180.747C55.1823 177.794 57.0556 176.001 57.8548 173.203C58.1613 172.131 58.2267 170.026 59.0705 169.089C59.9638 168.096 61.6451 166.853 61.7512 165.473C61.8109 164.697 64.0827 159.31 64.5255 160.859C65.0336 162.638 66.5438 162.231 68.1726 162.231C72.3778 162.231 74.9309 160.638 78.5838 162.667C79.9968 163.452 81.6268 162.982 82.792 163.914C83.8022 164.722 82.0937 167.281 83.9141 167.281C86.8447 167.281 85.4336 166.133 85.3168 163.914C85.2227 162.125 86.2525 161.572 86.439 159.987C86.5844 158.751 93.5651 158.952 94.5748 159.737C96.7757 161.449 100.298 162.201 102.711 163.478C104.126 164.227 105.696 163.497 106.919 164.475C107.844 165.216 106.469 167.353 108.072 167.811C109.465 168.209 111.484 167.842 112.935 167.842C114.984 167.842 115.106 166.489 116.301 165.161C118.804 162.38 116.953 161.44 116.145 158.615C115.765 157.283 114.392 150.612 113.371 150.012C111.85 149.117 110.005 149.476 110.005 147.362C110.005 146.032 109.835 144.999 108.571 144.276C106.978 143.366 106.278 143.154 104.394 143.154C101.359 143.154 102.711 142.512 102.711 140.099C102.711 137.856 104.872 135.963 106.202 134.301C108.566 131.346 105.516 130.114 105.516 127.163V121.272C105.516 119.609 107.117 119.135 107.885 117.905C109.267 115.694 113.774 115.437 115.896 114.258C117.252 113.505 123.36 112.296 121.912 110.486C121.567 110.055 124.937 102.593 125.435 102.195C126.542 101.309 130.054 98.4201 130.204 97.1449C130.493 94.6891 134.1 92.2944 131.045 89.8508C130.781 89.6393 129.67 85.8632 129.643 85.3621C129.56 83.8764 129.643 82.3618 129.643 80.8734C129.643 77.3145 131.282 76.6779 134.381 75.7925C138.043 74.7462 137.863 72.7523 137.498 69.6517C137.132 66.5413 135.285 65.0449 138.339 62.6693C140.568 60.9363 142.155 58.632 144.356 56.8714C146.52 55.1395 151.077 56.1228 153.489 54.7829C154.746 54.0843 157.088 55.2139 158.133 54.3777C158.927 53.7425 161.101 53.444 162.186 53.3802C165.71 53.1729 164.017 49.2219 165.833 47.7693C167.622 46.3378 168.048 43.4517 169.604 41.7221C170.594 40.6223 169.651 39.3443 171.475 38.8231C172.886 38.4199 174.248 38.9921 175.402 39.3219C176.979 39.7723 177.506 40.7168 179.018 41.4727C180.245 42.0862 181.989 41.7299 183.071 42.5949C184.437 43.688 188.841 44.4028 190.52 44.4028C192.883 44.4028 196.405 44.2958 198.22 42.8443C199.15 42.0999 200.603 41.8827 201.711 41.5662C203.118 41.1643 203.508 39.4603 204.267 38.5114C205.075 37.5012 206.352 37.5174 207.197 36.6723C208.219 35.6504 208.977 34.3317 210.003 33.3058C211.705 31.6034 211.043 27.9851 212.964 26.4481C214.243 25.4245 214.522 24.7985 213.369 23.518C212.067 22.0712 213.153 20.7144 213.244 19.154C213.381 16.8284 216.513 15.1547 218.575 14.6964C220.068 14.3646 221.817 14.7551 223.344 14.6653C224.157 14.6175 225.153 13.1055 225.713 12.5456C226.425 11.8336 227 10.5605 227 9.5C227 7.94344 226.742 6.5 226.742 5.9996C226.5 -3 233.495 4.56571 235.127 4.56571C241.159 4.56571 247 6.00001 251.959 6.24897C254 7.00001 252.83 10.7001 251.71 12.1404C250.636 13.5212 248.593 13.9162 248.593 16.068C248.593 17.641 246.538 19.2278 246.349 20.8372C246.148 22.5426 244.981 26.066 244.229 27.5702C243.86 28.3084 242.707 28.1137 242.452 29.0041C242.167 30.0014 242.982 30.7462 242.982 31.7784C242.982 34.239 244.665 36.2655 244.665 38.5114C244.665 41.5137 248.002 41.0425 248.562 43.5612C248.825 44.7475 247.238 47.3211 246.878 48.5798C245.814 52.3071 245.114 55.9835 248.718 58.8664C249.092 59.1661 250.571 59.4361 251.087 59.5833C251.649 59.744 252.43 61.5596 252.832 62.077C254.275 63.9316 255.51 65.5767 256.448 67.6879C258.055 71.3027 256.393 76.2754 259.129 79.3148C260.55 80.8944 262.538 82.965 263.618 84.801C264.691 86.6261 267.423 87.9252 268.106 89.9755C268.889 90.7582 270.339 92.1295 270.475 93.2173C270.629 94.4434 272.889 95.3195 273.717 96.1475C274.693 97.1236 274.964 99.126 274.964 100.511C274.964 102.603 273.803 108.319 274.839 109.614C275.76 110.765 276.474 111.365 277.645 112.419C278.734 113.399 278.33 115.127 278.33 116.502C278.33 119.738 277.603 122.28 276.775 125.174L276.678 125.511C275.993 127.91 272.622 129.317 270.756 130.81C269.895 131.499 268.919 132.474 268.231 133.335C267.566 134.166 266.968 135.86 266.267 136.421C264.398 137.916 263.038 140.718 263.181 143.154C263.284 144.907 265.738 148.766 266.984 150.012C268.889 151.917 270.023 154.046 271.722 155.934C273.318 157.707 275.185 161.366 277.769 161.67C281.193 162.073 279.781 167.095 281.416 168.403C283.254 169.873 280.374 175.697 281.978 175.697C285.695 175.697 284.723 179.922 281.946 180.716C279.654 181.371 278.055 183.992 275.774 184.643C274.336 185.054 272.255 184.674 270.756 184.674C269.202 184.674 269.061 186.745 267.67 186.919C266 187.127 260.332 189.028 259.254 189.599C256.933 190.828 255.486 193.232 254.796 195.647C253.563 199.962 254.085 207.11 256.885 210.609C257.656 211.573 256.783 213.182 258.131 213.975C259.602 214.841 260.58 216.472 262.059 217.342C265.128 219.147 267.948 223.2 270.195 225.945C271.903 228.033 273.246 230.5 274.839 232.491C275.159 232.891 275.493 236.279 275.525 236.855C275.602 238.248 275.525 239.668 275.525 241.063C275.525 243.627 273.842 245.949 273.842 248.358C273.842 250.34 269.315 253.127 273.842 253.127C276.26 253.127 280.208 252.433 280.014 255.932C279.903 257.932 276.086 259.299 274.964 260.702C273.282 262.804 271.597 262.991 271.597 266.312C271.597 269.058 275.78 270.47 272.159 272.079C269.046 273.462 258.384 273.817 256.323 270.521C255.144 268.633 249.765 266.951 248.156 268.962C247.529 269.746 248.09 272.33 248.032 273.326C247.966 274.451 245.528 273.96 245.258 273.014C244.533 270.477 242.901 267.154 239.896 267.154C237.843 267.154 235.084 265.739 233.568 264.224C232.666 263.322 230.756 263.544 229.641 262.541C228.573 261.58 227.39 260.465 226.149 259.735C225.605 259.415 222.872 256.668 222.783 258.177C222.688 259.784 222.683 260.545 221.661 261.824C220.809 262.888 219.543 263.013 218.575 263.787C217.192 264.894 218.294 265.69 218.294 267.154C218.294 269.617 219.647 272.204 215.769 272.204C210.595 272.204 205.977 269.398 200.901 269.398C198.23 269.398 197.599 272.503 194.479 271.612C192.786 271.128 189.619 269.806 188.12 272.204C187.373 273.399 185.864 279.86 183.382 277.378C181.981 275.977 184.073 274.944 185.19 274.323C186.535 273.576 186.158 271.878 187.154 271.082C189.045 269.569 189.679 266.604 189.679 264.349C189.679 262.064 189.639 258.636 188.557 256.743C187.941 255.666 180.485 254.759 183.226 252.566C184.554 251.504 181.038 252.005 180.421 252.005C178.914 252.005 177.632 251.444 176.213 251.444C174.683 251.444 173.967 250.07 172.971 249.075C172.008 248.111 170.415 249.05 169.355 248.202C168.256 247.322 162.289 247.882 161.344 248.638C160.512 249.304 161.194 251.251 160.191 252.254C159.275 253.17 157.527 253.127 156.294 253.127C154.794 253.127 152.004 249.531 151.089 248.513C150.01 247.315 150.918 245.643 149.966 244.586C149.352 243.903 147.381 242.737 146.475 243.869C144.475 246.37 140.21 245.707 142.111 241.905C142.755 240.617 144.024 239.825 144.667 238.539C145.617 236.639 143.87 236.374 143.233 235.172C141.458 231.818 145.868 231.266 146.444 229.249C146.826 227.914 146.555 221.768 144.48 221.768C143.057 221.768 141.624 222.592 140.023 222.236C138.506 221.899 138.104 221.145 136.376 221.145C133.871 221.145 131.102 222.375 130.765 225.073C130.667 225.857 127.549 225.979 126.962 225.509C126.044 224.775 125.625 223.43 124.873 222.828C124.188 222.28 124.172 220.808 123.19 220.023C121.859 218.958 124.002 216.465 124.468 215.534C125.008 214.454 124.684 212.043 124.156 211.045C123.443 209.698 120.86 210.869 119.855 211.326C118.063 212.141 115.759 212.891 114.244 214.131C111.966 215.995 110.323 217.913 107.511 219.15C103.94 220.721 100.895 221.589 98.0971 224.387C96.3192 226.165 100.196 228.481 101.152 229.437C103.582 231.867 102.685 234.504 100.154 236.575C98.1956 238.177 92.5681 238.152 94.8553 242.154C95.4678 243.226 97.0996 242.963 97.0996 244.43C97.0996 245.777 96.4571 246.612 96.5386 248.077C96.6242 249.619 98.3431 255.274 96.8191 256.493C95.1648 257.817 99.1367 261.662 97.536 263.663C96.2166 265.312 92.606 265.207 90.3666 265.471C88.9467 265.638 87.6285 266.647 86.3143 265.595C85.6114 265.033 83.7077 264.91 82.7919 264.91C79.3511 264.91 80.0293 261.386 78.7085 259.735C77.1337 257.767 75.2717 257.19 72.7236 256.462C70.4453 255.811 69.7808 251.835 67.1127 252.597C65.7084 252.998 66.1438 254.775 65.3983 255.371C64.5342 256.062 63.4345 256.543 63.4345 257.616C63.4345 259.089 63.358 260.243 63.4345 261.543C63.5038 262.722 63.1705 264.063 62.0629 264.38Z"
              stroke="black"
              strokeWidth="1"
              strokeLinecap="round"
            />
          </svg>

          <div className="text-center">Vijapur</div>
        </CardBody>
      </Card>
      <Card className="flex justify-center max-w-md w-full mb-2">
        <CardBody>
          <p>
            {vijapurTotal ? `Total population: ${vijapurTotal}` : <Spinner />}
          </p>
          <p>
            {vijapurData ? (
              ` No of Schools: ${vijapurData.no_of_schools}`
            ) : (
              <Spinner />
            )}
          </p>
          <p>
            {vijapurData ? (
              ` No of Colleges: ${vijapurData.no_of_colleges}`
            ) : (
              <Spinner />
            )}
          </p>
          <p>
            {vijapurData ? (
              ` No of Universities: ${vijapurData.no_of_universities}`
            ) : (
              <Spinner />
            )}
          </p>
          <p>
            {vijapurData ? (
              ` No of Bus Stations: ${vijapurData.no_of_bus_stations}`
            ) : (
              <Spinner />
            )}
          </p>
          <p>
            {vijapurData ? (
              ` No of Railway Stations: ${vijapurData.no_of_railway_stations}`
            ) : (
              <Spinner />
            )}
          </p>
          <p>
            {vijapurData ? (
              ` No of Post Offices: ${vijapurData.no_of_post_offices}`
            ) : (
              <Spinner />
            )}
          </p>
          <p>
            {vijapurData ? (
              ` No of Police Stations: ${vijapurData.no_of_police_stations}`
            ) : (
              <Spinner />
            )}
          </p>
          <p>
            {vijapurData ? (
              ` No of Fire Stations: ${vijapurData.no_of_fire_stations}`
            ) : (
              <Spinner />
            )}
          </p>
          <p>
            {vijapurData ? (
              ` No of Hospitals: ${vijapurData.no_of_hospitals}`
            ) : (
              <Spinner />
            )}
          </p>
        </CardBody>
      </Card>
    </div>
  );
};

export default VijapurMap;
